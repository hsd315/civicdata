identity:
  creator: eric@clarinova.com
  dataset: alcohol_licenses
  id: a2iLPd
  revision: 1
  source: abc.ca.gov
  subset: null
  variation: orig
about:
  title: 'SANDAG City Alcohol Permits'
  description: > 
    Records extracted from the California Alcohol Beverage Control website for
    the 18 SANDAG cities:
      
    Carlsbad, Chula Vista, Coronado, Del Mar, El Cajon, Encinitas, Escondido, 
    Imperial Beach, La Mesa, Lemon Grove, National City, Oceanside, 
    Poway, San Diego, San Marcos, Santee, Solana Beach, Vista
  maintainer: Eric Busboom
  author: Eric Busboom
  homepage: http://www.abc.ca.gov/datport/AHCity.asp
  url: http://www.abc.ca.gov/datport/AHCity.asp
  license: other-open
  tags: [government,gov-licenses,business, bus-economy]
build:
  api_url: 'http://www.abc.ca.gov/datport/AHCityRep.asp'
  # Payloads for report that do specify a license type
  lt_payload_template: 'q_CityLOV={city}&q_LTLOV={license_type}&RPTYPE=p_Lictype&SUBMIT1=Continue'
  # Payload for reports that don't specify a particular liscentype. Must speify the report type
  report_payload_template: 'q_CityLOV={city}&q_LTLOV=01&RPTYPE={report_type}&SUBMIT1=Continue'
  schema_file: meta/schema.csv
meta:
  meta_url: http://www.abc.ca.gov/datport/AHCity.asp
  license_categories:
    p_OnSale: 'Active On-Sale Retail Licenses: Restaurants and bars'
    p_OffSale: 'Active Off-Sale Retail Licenses: Stores'
    p_Retail: 'On-Sale and Off-Sale'
    p_NonRetail: 'Non-Retail: Wineries and Distileries'
  target_cities: # Cities that we actually do requests for
    - CARLSBAD
    - CHULA VISTA
    - CORONADO
    - DEL MAR
    - EL CAJON
    - ENCINITAS
    - ESCONDIDO
    - IMPERIAL BEACH
    - LA MESA
    - LEMON GROVE
    - NATIONAL CITY
    - OCEANSIDE
    - POWAY
    - SAN DIEGO
    - SAN MARCOS
    - SANTEE
    - SOLANA BEACH
    - VISTA
extracts:
  - partition: any
    query: 'select * from licenses'
    title: 'SANDAG Cities ABC Licenses, {p_time}'
    description: > 
      Alcohol Beverage Control licenses, for the
      SANDAG cities, for the year {p_time}
    name: 'licenses-{p_time}.csv'
    for: "partition.identity.table == 'licenses'"

  
